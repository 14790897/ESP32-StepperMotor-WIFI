# 更新日志

## v2.1.0 - 分钟级别控制 (2024-12-XX)

### ✨ 新增功能
- **分钟级别时间设置**：支持分钟+秒的精确时间控制
  - 分钟范围：0-60分钟
  - 秒范围：0-59秒
  - 最长支持60分钟连续运行
- **快捷时间按钮**：一键设置常用时间
  - 30秒、1分钟、2分钟、5分钟、10分钟
- **智能时间显示**：自动格式化时间显示
  - 仅秒：`30秒`
  - 仅分钟：`5分钟`
  - 分钟+秒：`2分30秒`
- **增强API接口**：支持分钟参数
  - 新增 `minutes` 和 `seconds` 参数
  - 兼容原有 `duration` 参数

### 🎨 界面改进
- 重新设计定时控制面板
- 添加分钟和秒的独立输入框
- 新增快捷时间按钮组
- 优化时间输入验证

### 🔧 技术改进
- 增强时间参数处理逻辑
- 优化时间显示格式化
- 改进API参数解析
- 添加时间范围验证

### 📊 性能指标
- RAM使用：11.9% (无变化)
- Flash使用：63.1% (增加0.2%)
- 支持最长运行时间：60分钟
- 时间精度：±1秒

---

## v2.0.0 - 简化版本 (2024-12-XX)

### 🗑️ 移除功能
- **循环旋转功能**：移除了复杂的循环控制功能
  - 删除了循环次数设置
  - 删除了无限循环模式
  - 删除了循环状态显示
  - 删除了循环相关的API接口

### ✅ 保留功能
- **基本控制**：正转/反转一圈、半圈、90度
- **速度控制**：1-100%可调速度
- **定时旋转**：设定旋转持续时间（1-3600秒）
- **WiFi控制**：完整的Web界面
- **实时状态**：运行状态、速度、最后命令显示

### 🎯 简化原因
1. **降低复杂性**：移除不常用的循环功能，专注核心功能
2. **提高稳定性**：减少代码复杂度，降低出错概率
3. **易于理解**：简化用户界面，更容易上手使用
4. **维护性**：减少代码量，便于后续维护和扩展

### 📱 界面变化
- 移除了"循环旋转"控制面板
- 移除了"循环状态"显示区域
- 保留了所有其他控制功能
- 界面更加简洁清晰

### 🔧 技术改进
- 优化了非阻塞控制逻辑
- 简化了状态管理
- 减少了内存使用
- 提高了响应速度

### 📊 性能指标
- RAM使用：11.9% (减少0.5%)
- Flash使用：62.9% (减少1.2%)
- 响应时间：< 100ms
- 编译时间：< 4秒

---

## v1.0.0 - 完整功能版本

### ✨ 主要功能
- 基本步进电机控制
- WiFi Web界面
- 速度控制
- 定时旋转
- 循环旋转（已移除）
- 实时状态监控

### 🔧 技术特性
- 非阻塞架构
- RESTful API
- 响应式Web设计
- 实时状态更新

---

## 升级指南

### 从v1.0.0升级到v2.0.0

#### 代码变化
- 移除了所有循环相关的函数和变量
- 简化了状态管理逻辑
- 更新了Web界面HTML/CSS/JavaScript

#### API变化
- 移除了 `/advanced?action=loop` 接口
- 简化了 `/status` 返回的JSON格式
- 保留了所有其他API接口

#### 配置变化
- 无需修改WiFi配置
- 无需修改硬件连接
- 无需修改引脚定义

#### 迁移步骤
1. 备份当前代码（如需要）
2. 更新到新版本代码
3. 重新编译上传
4. 测试基本功能
5. 验证Web界面正常

### 功能对比

| 功能 | v1.0.0 | v2.0.0 | 说明 |
|------|--------|--------|------|
| 基本控制 | ✅ | ✅ | 无变化 |
| 速度控制 | ✅ | ✅ | 无变化 |
| 定时旋转 | ✅ | ✅ | 无变化 |
| 循环旋转 | ✅ | ❌ | 已移除 |
| WiFi控制 | ✅ | ✅ | 无变化 |
| Web界面 | ✅ | ✅ | 简化界面 |
| 实时状态 | ✅ | ✅ | 简化状态 |

### 如果需要循环功能

如果您的应用确实需要循环功能，可以：

1. **手动实现**：使用定时旋转功能，手动重复操作
2. **外部控制**：通过外部程序调用API实现循环
3. **回退版本**：继续使用v1.0.0版本

#### 外部循环实现示例

```bash
# 使用脚本实现3次循环，每次5秒
for i in {1..3}; do
  echo "循环 $i/3"
  curl "http://192.168.1.100/advanced?action=timed&direction=cw&duration=5"
  sleep 6  # 等待完成
done
```

```python
# Python实现循环控制
import requests
import time

def loop_rotation(ip, direction, duration, loops):
    for i in range(loops):
        print(f"循环 {i+1}/{loops}")
        url = f"http://{ip}/advanced?action=timed&direction={direction}&duration={duration}"
        requests.get(url)
        time.sleep(duration + 1)  # 等待完成

# 使用示例
loop_rotation("192.168.1.100", "cw", 5, 3)
```

---

## 反馈与支持

如果您对功能简化有任何意见或建议，请通过以下方式反馈：

1. 在项目中创建Issue
2. 提供详细的使用场景说明
3. 说明是否需要恢复循环功能

我们会根据用户反馈考虑在未来版本中恢复或改进相关功能。
